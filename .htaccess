<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /hotel-booking/

    # Allow direct access to assets and error pages
    RewriteCond %{REQUEST_URI} ^/hotel-booking/(assets|403|404|500)/ [NC]
    RewriteRule ^ - [L]

    # Redirect root to /public/ (only if not already in /public/)
    RewriteCond %{REQUEST_URI} !^/hotel-booking/public/ [NC]
    RewriteRule ^$ public/ [L]

    # Remove .php extension (allow /file instead of /file.php)
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}\.php -f
    RewriteRule ^(.+?)/?$ $1.php [L]

    # API rewrite rules
    RewriteRule ^api/([^/]+)/([^/]+)/?$ api.php?rquest=$2&namespace=$1 [L,QSA]
    RewriteRule ^api/([^/]+)/?$ api.php?rquest=$1 [L,QSA]

    # Block sensitive folders and redirect to error pages
    RewriteCond %{REQUEST_URI} ^/hotel-booking/(libs|api|vendor|env)/ [NC]
    RewriteRule ^ - [E=ACCESS_DENIED:1]

    # Handle 403 errors
    RewriteCond %{ENV:ACCESS_DENIED} =1
    RewriteRule ^ - [R=403,L]

    # Handle 404 errors for non-existent files
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^ - [R=404,L]

    # Handle 500 errors (server errors are handled by PHP)
</IfModule>

# Error document handling
ErrorDocument 403 /hotel-booking/403
ErrorDocument 404 /hotel-booking/404
ErrorDocument 500 /hotel-booking/500